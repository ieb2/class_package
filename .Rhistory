ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
grouping_variable, "=", levels_vector[[2]]
))
ggpubr::ggarrange(qq_1, qq_2)
}
drop_na(penguins) %>%
independent_qq_plot(., "bill_length_mm", "sex")
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
data.frame(diff = first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
variable, "in order of "
first_group, "-", second_group, "for",
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
data.frame(diff = first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
variable, "in order of: ",
first_group, "-", second_group, "for",
))
}
dependent_qq_plot(penguins, "bill_length_mm", "sex", "female", "male")
dependent_qq_plot(drop_na(penguins), "bill_length_mm", "sex", "female", "male")
dependent_qq_plot(drop_na(penguins), "bill_length_mm", "sex", "female", "male")
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
data.frame(diff = first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
variable, "in order of: ",
first_group, "-", second_group,
))
}
dependent_qq_plot(drop_na(penguins), "bill_length_mm", "sex", "female", "male")
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
data.frame(diff = first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
variable, "in order of: ",
first_group, "-", second_group
))
}
dependent_qq_plot(drop_na(penguins), "bill_length_mm", "sex", "female", "male")
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
data.frame(diff = first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
variable, " in order of: ",
first_group, "-", second_group
))
}
dependent_qq_plot(drop_na(penguins), "bill_length_mm", "sex", "female", "male")
styler:::style_active_file()
Depends: matrixStats
roxygen2::roxygenise()
Depends: matrixStats
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
warnings()
roxygen2::roxygenise()
warnings()
roxygen2::roxygenise()
roxygen2::roxygenise()
roxygen2::roxygenise()
superior_almost_sas(lm(hp ~ vs + carb, data = mtcars), binwidth = 4)
superior_almost_sas(lm(hp ~ vs + carb, data = mtcars), binwidth = 4))
superior_almost_sas(lm(hp ~ vs + carb, data = mtcars), binwidth = 4))
superior_almost_sas(lm(hp ~ vs + carb, data = mtcars), binwidth = 4)
superior_almost_sas(lm(hp ~ vs + carb, data = mtcars), binwidth = 4)
superior_almost_sas(lm(hp ~ vs + carb, data = mtcars))
superior_almost_sas(lm(hp ~ vs + mpg, data = mtcars))
superior_almost_sas(lm(hp ~ mpg, data = mtcars))
library(tidyverse)
library(penguins)
library(palmerpenguins)
independent_qq_plot <- function(data, variable, grouping_variable) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
qq_1 <-
ggplot2::ggplot(
split_dfs[[1]],
aes(sample = get(variable))
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0("QQ Plot for ",
sep = "",
grouping_variable, "=", levels_vector[[1]]
))
qq_2 <-
ggplot2::ggplot(
split_dfs[[2]],
aes(sample = get(variable))
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ", variable, ": ",
grouping_variable, "=", levels_vector[[2]]
))
ggpubr::ggarrange(qq_1, qq_2)
}
independent_qq_plot(drop_na(penguins), "bill_length_mm", "sex")
qq_1 <-
ggplot2::ggplot(
split_dfs[[1]],
aes(sample = get(variable))
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ", variable, ": ",
grouping_variable, "=", levels_vector[[1]]
))
qq_2 <-
ggplot2::ggplot(
split_dfs[[2]],
aes(sample = get(variable))
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ", variable, ": ",
grouping_variable, "=", levels_vector[[2]]
))
independent_qq_plot <- function(data, variable, grouping_variable) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
qq_1 <-
ggplot2::ggplot(
split_dfs[[1]],
aes(sample = get(variable))
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ", variable, ": ",
grouping_variable, "=", levels_vector[[1]]
))
qq_2 <-
ggplot2::ggplot(
split_dfs[[2]],
aes(sample = get(variable))
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ", variable, ": ",
grouping_variable, "=", levels_vector[[2]]
))
ggpubr::ggarrange(qq_1, qq_2)
}
independent_qq_plot(drop_na(penguins), "bill_length_mm", "sex")
independent_qq_plot(mtcars, "hp", "vs")
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
data.frame(diff = first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ",
variable, " in order of: ",
first_group, "-", second_group
))
}
dependent_qq_plot(mtcars, "hp", "vs", "1", "0")
dependent_qq_plot(mtcars, "hp", "vs", "1", "2")
dependent_qq_plot(mtcars, "hp", "vs", "1", "10")
if(first_group_df[[1]][[grouping_variable]][[1]] != first_group){
stop(cat(first_group, "does not exist"))
}
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
diff <- first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]
if(first_group_df[[1]][[grouping_variable]][[1]] != first_group){
stop(cat(first_group, "does not exist"))
}
data.frame(diff) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ",
variable, " in order of: ",
first_group, "-", second_group
))
}
dependent_qq_plot(mtcars, "hp", "vs", "10", "0")
dependent_qq_plot <- function(data, variable, grouping_variable, first_group, second_group) {
split_dfs <- data %>%
dplyr::group_split(get(grouping_variable))
levels_vector <-
sapply(split_dfs, function(x) (x[[grouping_variable]])[[1]]) %>%
as.character()
if (length(split_dfs) < 2) {
stop(cat("There are less than two levels to the grouping variable, it is", levels_vector, "\n"))
} else if (length(split_dfs) > 2) {
stop(cat("There are more than two levels to the grouping variable, they are:", levels_vector, "\n"))
}
first_group_df <-
ifelse(split_dfs[[1]][[grouping_variable]][[1]] == first_group,
split_dfs[1], split_dfs[2]
)
second_group_df <-
ifelse(split_dfs[[2]][[grouping_variable]][[1]] == second_group,
split_dfs[2], split_dfs[1]
)
diff <- first_group_df[[1]][[variable]] - second_group_df[[1]][[variable]]
if(first_group_df[[1]][[grouping_variable]][[1]] != first_group){
stop(cat(first_group, "is not a valid level of the grouping variable"))
}
if(second_group_df[[1]][[grouping_variable]][[1]] != second_group){
stop(cat(second_group, "is not a valid level of the grouping variable"))
}
data.frame(diff) %>%
ggplot2::ggplot(
.,
aes(sample = diff)
) +
ggplot2::stat_qq_line(
linetype = "dashed",
color = "black", linewidth = 1
) +
ggplot2::stat_qq(color = "#6A6C6E") +
ggplot2::theme_bw() +
ggplot2::labs(x = "Theoretical", y = "Sample", title = paste0(
"QQ Plot for ",
variable, " in order of: ",
first_group, "-", second_group
))
}
dependent_qq_plot(mtcars, "hp", "vs", "10", "0")
dependent_qq_plot(mtcars, "hp", "vs", "0", "10")
dependent_qq_plot(mtcars, "hp", "vs", "0", "1")
independent_qq_plot(mtcars, "hp", "vs"")
independent_qq_plot(mtcars, "hp", "vs)
independent_qq_plot(mtcars, "hp", "vs")
dependent_qq_plot(mtcars, "hp", "vs")
independent_qq_plot(mtcars, "hp", "vs")
dependent_qq_plot(mtcars, "hp", "vs", "0", "1")
dependent_qq_plot(mtcars, "hp", "vs", "02", "1")
dependent_qq_plot(mtcars, "hp", "vs", "02", "1")
dependent_qq_plot(mtcars, "hp", "vs", "02", "1")
data.frame(grouping_variable = rep(c(0,1), each = 50))
data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement_one = rnorm(50, -1, 1),
measurement_two = rnorm(50, 1, 1))
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1))
data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
dependent_qq_plot(., "measurement", "grouping_variable", "1", "0")
data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1))) %>%
dependent_qq_plot(., "measurement", "grouping_variable", "1", "0")
data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1))) %>%
dependent_qq_plot(., "measurement", "grouping_variable", "1", "0")
data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
test_df <- data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
test_df <- data.frame(grouping_variable = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
dependent_qq_plot(test_df, "measurement", "grouping_variable", "1", "0")
dependent_qq_plot(test_df, "measurement", grouping_variable = "grouping_variable", "1", "0")
rlang::last_trace()
split_dfs <- test_df %>%
dplyr::group_split(get("grouping_variable"))
split_dfs
test_df <- data.frame(qqq = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
dependent_qq_plot(test_df, "measurement", grouping_variable = "qqq", "1", "0")
test_df <- data.frame(abs = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
dependent_qq_plot(test_df, "measurement", "abs", "1", "0")
test_df <- data.frame(grouping = rep(c(0,1), each = 50),
measurement = c(rnorm(50, -1, 1), rnorm(50, 1, 1)))
dependent_qq_plot(test_df, "measurement", "grouping", "1", "0")
dependent_qq_plot(test_df, "measurement", "grouping", "2", "0")
dependent_qq_plot(test_df, "measurement", "grouping", "0", "0")
dependent_qq_plot(test_df, "measurement", "grouping", "0", "1")
